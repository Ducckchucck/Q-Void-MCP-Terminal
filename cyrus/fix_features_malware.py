import pandas as pd
import numpy as np

DATA_PATH = "datasets/piyush/SQL/Modified_SQL_Dataset.csv"

print(f"ğŸ“‚ Loading dataset: {DATA_PATH}")
df = pd.read_csv(DATA_PATH)

print("\nğŸ” Basic Info:")
print(df.info())

print("\nğŸ“Š Label Distribution:")
print(df['Label'].value_counts())

print("\nâ“ Missing Values (Nulls):")
print(df.isnull().sum())

print("\nâš ï¸ NaNs or Infs in entire dataset:")
print(df.replace([np.inf, -np.inf], np.nan).isnull().sum())

print("\nğŸ” Sample of rows with Label=1 (Malicious):")
print(df[df['Label'] == 1].head())

print("\nğŸ” Sample of rows with Label=0 (Benign):")
print(df[df['Label'] == 0].head())

print("\nğŸ“Œ Unique Labels:")
print(df['Label'].unique())

if df['Label'].nunique() > 2:
    print("âš ï¸ Warning: More than 2 label classes found.")

if df.duplicated().sum() > 0:
    print(f"âš ï¸ Warning: {df.duplicated().sum()} duplicate rows found.")



print("\nâœ… Dataset check complete.")
