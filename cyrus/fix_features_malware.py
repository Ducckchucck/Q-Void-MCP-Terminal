import pandas as pd
import numpy as np

DATA_PATH = "datasets/piyush/SQL/Modified_SQL_Dataset.csv"

print(f"📂 Loading dataset: {DATA_PATH}")
df = pd.read_csv(DATA_PATH)

print("\n🔍 Basic Info:")
print(df.info())

print("\n📊 Label Distribution:")
print(df['Label'].value_counts())

print("\n❓ Missing Values (Nulls):")
print(df.isnull().sum())

print("\n⚠️ NaNs or Infs in entire dataset:")
print(df.replace([np.inf, -np.inf], np.nan).isnull().sum())

print("\n🔎 Sample of rows with Label=1 (Malicious):")
print(df[df['Label'] == 1].head())

print("\n🔎 Sample of rows with Label=0 (Benign):")
print(df[df['Label'] == 0].head())

print("\n📌 Unique Labels:")
print(df['Label'].unique())

if df['Label'].nunique() > 2:
    print("⚠️ Warning: More than 2 label classes found.")

if df.duplicated().sum() > 0:
    print(f"⚠️ Warning: {df.duplicated().sum()} duplicate rows found.")



print("\n✅ Dataset check complete.")
